<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Beitrag hochladen</title>
    <link rel="stylesheet" href="https://constructorable.github.io/katalog_03/css.css">
</head>
<body>

    <div class="main-container">
        <h2>Admin Dashboard</h2>

        <!-- Formular zum Hochladen eines Beitrags -->
        <form id="postForm">
            <textarea id="postText" placeholder="Geben Sie Ihren Beitrag ein..." rows="6" required></textarea><br>
            <button type="submit">Beitrag hochladen</button>
        </form>

        <div id="statusMessage" style="margin-top: 20px; color: green;"></div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js";
        import { getDatabase, ref, set, push } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-database.js";
        import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-storage.js";
      

        const firebaseConfig = {
            apiKey: "AIzaSyB3f-7rNLiqLvDJ0GZY3rkNd34oxLuAg90",
            authDomain: "simom002.firebaseapp.com",
            databaseURL: "https://simom002-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "simom002",
            storageBucket: "simom002.firebasestorage.app",
            messagingSenderId: "174254147862",
            appId: "1:174254147862:web:3506bdbcf8a0d4d8d96837"
        };

        const app = initializeApp(firebaseConfig);
        const storage = getStorage(app);
        const database = getDatabase(app);

        // Formular zum Hochladen eines Beitrags
        const postForm = document.getElementById('postForm');
        const postText = document.getElementById('postText');
        const statusMessage = document.getElementById('statusMessage');

// Event Listener f端r das Formular
    postForm.addEventListener('submit', async (event) => {
        event.preventDefault();  // Verhindert das normale Absenden des Formulars

        const text = postText.value.trim();  // Text aus dem Textarea extrahieren

        if (text) {
            try {
                // Referenz auf den "posts"-Knoten in der Firebase-Datenbank
                const postsRef = ref(database, 'posts');

                // Einen neuen Beitrag mit push() hinzuf端gen
                const newPostRef = push(postsRef);
                
                // Den Text und den Zeitstempel setzen
                await set(newPostRef, {
                    text: text,
                    timestamp: new Date().toISOString()  // Zeitstempel f端r den Beitrag
                });

                // Erfolgsnachricht
                statusMessage.style.color = 'green';
                statusMessage.textContent = 'Beitrag erfolgreich hochgeladen!';
                postText.value = '';  // Textfeld zur端cksetzen

            } catch (error) {
                console.error("Fehler beim Hochladen des Beitrags: ", error);
                statusMessage.style.color = 'red';
                statusMessage.textContent = `Fehler: ${error.message}`;
            }
        } else {
            statusMessage.style.color = 'red';
            statusMessage.textContent = 'Bitte geben Sie einen Text ein!';
        }
    });
    </script>

</body>
</html>
